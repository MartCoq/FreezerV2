version: "3.9"

services:

# docker mariadb
  mariadb:
    build: ./maria/
    image: "mariadb"
    networks:
      FreezerNetwork:
        ipv4_address: 172.18.0.1

# docker jenkins
  jenkins:
    build: ./jenkins/
    image: "jenkins"
    networks:
      FreezerNetwork:
        ipv4_address: 172.18.0.2
    depends_on:
      - "Agent"

# docker agent
  agent:
    build: ./agent/
    image: "agent"
    networks:
      FreezerNetwork:
        ipv4_address: 172.18.0.3

# docker proftpd
  proftpd :
    build: ./proftpd/
    image: "pro"
    networks:
      FreezerNetwork:
        ipv4_address: 172.18.0.4

# docker nginx
  nginx :
    build: ./nginx/
    image: "nginx"
    ports:
      - "80:80"
      - "443:443"
    networks:
      FreezerNetwork:
        ipv4_address: 172.18.0.5
    depends_on:
      - "mariadb"
      - "proftpd"
      - "jenkins"
      - "agent"

# définition du réseau
networks:
  FreezerNetwork:
    ipam:
      driver: default
      config:
        - subnet: "172.18.0.0/24"
